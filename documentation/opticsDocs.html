<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<title>opticsDocs</title>
</head>

<body bgcolor="#FFFFFF">

<h1 align="center">optics module documentation</h1> The optics module contains
support for devices used to modify the x-ray beam from a synchrotron source and
apply it in experimentally useful ways, including a variety of monochromators,
slits, filters, mirrors, diffractometers, and optical tables.

	<H3>Monochromators</H3> synApps supports two geometries of high-heat-load,
	non-dispersive double-crystal monochromator: Kohzu/PSL geometry 1, and
	Kohzu geometry 2.  In geometry 1, the monochromator crystals rotate about a
	point vertically midway between the entrance and exit beams; in geometry 2,
	the crystals rotate about a point on the surface of the first crystal.  One
	or both crystals also translate, as they rotate, to keep the exit beam at a
	fixed height above the entrance beam

	<H4>Kohzu/PSL geometry 1 (Theta, Y1, Z2)</H4>

	<center><IMG SRC="kohzuGraphic.adl.gif"><br>kohzuGraphic.adl</IMG></center>

	<P>This MEDM display is a picture of Kohzu/PSL geometry 1, with white beam
	entering from the left, monochromatized radiation diffracting upward from
	the first crystal and then forward from the second crystal.  The crystal
	stages are mounted on a plate which rotates about a point midway,
	vertically, between the incident and exiting beam.

	<P>The difference in height between the incident beam and the point about
	which the plate rotates is called the monochromator offset, and the
	software allows this offset to be changed by a knowledgeable developer,
	though not by the casual user.  (Note that users sometimes use 'offset' to
	mean the vertical distance between the incident and exit beams, which is
	twice the offset as defined here.)  The crystals normally translate, as the
	plate rotates, to keep the first crystal in the incident beam, and to
	maintain the exiting beam at constant height.

	<P>As the monochromator rotates from a Bragg angle ('Theta") of zero, the
	first crystal moves away from the rotation point along a line normal to its
	diffracting planes, executing the equation

		<UL><PRE>Y = -offset/cos(Theta).</PRE></UL>

	<br>Thus, <code>Y(Theta=0) = -offset</code>, and a positive- sense motion
	would move the crystal toward the rotation point.

	<P>At the same time, the second crystal moves toward the rotation point
	along a line which is parallel to the crystal's diffracting planes, and
	which intersects the rotation point, according to the equation

		<UL><PRE>Z = offset/sin(Theta).</PRE></UL>

	<br>Thus, a positive-sense motion of the second crystal moves it in the
	direction of the exiting beam.

	<P>Because the Y and Z motions are nonlinear functions of Theta, their
	speeds ideally should vary as they move.  The software doesn't attempt
	this, but it does attempt to set motor speeds to the closest linear
	approximation to ideal behavior.  This means that it attempts to set motor
	speeds so that Theta, Y, and Z all move for the same length of time.  The
	attempt may not succeed, however, because the motors have high and low
	speed limits, and will refuse commands to violate them.

	<HR>

	<center><IMG SRC="kohzuSeqCtl_All.adl.gif">
	<br>kohzuSeqCtl_All.adl</img></center>

	<P>This MEDM display serves both geometries, and contains all of the
	user-modifiable fields that control and set them up.  Smaller, less
	complicated displays are also provided.

	<P>At top left, crystal parameters are selected from a list that includes
	Silicon (at room temperature, and at 77K), Germanium, and Diamond.  Miller
	indices can also be specified.  When fields in this section are modified,
	the resulting reflection is checked, and the software is put into
	Manual-Move mode (described below).

	<P>The monochromator can be driven in energy, wavelength, or angle. 
	Undriven fields are kept consistent automatically with driven fields.

	<P>The software can be in Manual-Move, or Auto_Move mode.  In Manual-Move
	mode, changes to energy, wavelength, or theta are not sent to the motors
	until the user issues a "Move" command.  In Auto_Move mode, changes to
	energy, wavelength, or theta are sent to the motors without further
	prompting from the user.

	<P>The manner in which 'Y', and 'Z' motions of monochromator crystals are
	calculated depends on the setting of a second mode switch, with the
	following options:

	<UL><table border=0>

	<TR valign="top"><TD>Normal<TD>-<TD>Y,Z driven per equations described
	above.

	<TR valign="top"><TD>Channel Cut<TD>-<TD>Y,Z are left at their current
	positions

	<TR valign="top"><TD>Freeze Z<TD>-<TD>Z is left at its current position

	<TR valign="top"><TD>Freeze Y<TD>-<TD>Y is left at its current position

	</table></UL>

	<HR>

	<H4>Kohzu geometry 2 (Theta, Y2, Z2)</H4>
	
	<center><IMG SRC="kohzu2Graphic.adl.gif">
	<br>kohzu2Graphic.adl</img></center>

	<P>This MEDM display is a picture of Kohzu/PSL geometry 2, with white beam
	entering from the left, monochromatized radiation diffracting upward from
	the first crystal and then forward from the second crystal.  The crystal
	stages are mounted on a plate which rotates about a point on the surface on
	of the first crystal.

	<P>The difference in height between the entrance and exit beams is called
	the monochromator offset, and the software allows this offset to be changed
	by the user.  (Note this geometry's 'offset' is different from that of the
	Kohzu 1 geometry.)  The second crystal normally translates, as the plate
	monochromator rotates, to maintain the exiting beam at constant height.

	<P>As the monochromator rotates from a Bragg angle ('Theta") of zero, the
	second crystal moves upward along a line normal to its diffracting planes,
	executing the equation

		<UL><PRE>Y = -offset/(2*cos(Theta)).</PRE></UL>

	<P>At the same time, the second crystal moves toward the rotation point
	along a line which is parallel to the crystal's diffracting planes,
	according to the equation

		<UL><PRE>Z = offset/(2*sin(Theta)).</PRE></UL>

	<br>Thus, a positive-sense motion of the second crystal moves it in the
	direction of the exiting beam.

	<P>Because the Y and Z motions are nonlinear functions of Theta, their
	speeds ideally should vary as they move.  The software doesn't attempt
	this, but it does attempt to set motor speeds to the closest linear
	approximation to ideal behavior.  This means that it attempts to set motor
	speeds so that Theta, Y, and Z all move for the same length of time.  The
	attempt may not succeed, however, because the motors have high and low
	speed limits, and will refuse commands to violate them.

	<HR>

	<H4>High-resolution double-crystal (Theta<sub>1</sub>,
	Theta<sub>2</sub>)</H4> synApps currently supports two geometries of a high
	energy-resolution, dispersive double crystal monochromator.  Both
	geometries actually employ four crystals, but two of the crystals are
	channel-cut partners of the other two, and therefore are not driven. 
	Crystal angles for these monochromators are described and controlled with
	three sets of variables:

	<UL><table border=0>

	<TR valign="top"><TD>Theta<TD>-<TD>Bragg angle, the angle between beam
	incident on a crystal and the crystal's diffracting planes.  

	<TR valign="top"><TD>Phi<TD>-<TD>The angle between the crystal's diffracting
	planes and the horizontal.  (By definition here, the beam incident on the
	monochromator is "horizontal".  Note that small changes in incident-beam
	direction can be accommodated by the "world" offset, shown in the control
	displays below.)  

	<TR valign="top"><TD>dPhi<TD>-<TD>(not shown in the diagram below) The
	difference between the actual angle, Phi, and the nominal value of this
	angle, Phi<sub>0</sub>.  These are the motors actually driven by the
	software.  The hardware for which this software was designed has extremely
	high resolution (nanoradian) rotation stages with very limited angular
	ranges.

	</table></UL>

	<P>

	<P><center><IMG SRC="hr_nested.adl.gif"> <br>hr_nested.adl (nested
	geometry)</IMG></center>

	<P>This display is a cartoon of the nested high-resolution monochromator
	geometry, defining the meanings of the angles Theta and Phi.

	<P>In this diagram, the crystals are drawn as if their diffracting planes
	were parallel to the crystal surface.  This is not always the case in
	actual practice, particularly for the first crystal of the nested geometry,
	which typically is asymmetrically cut to match the incident beam divergence
	to the angular range over which the second crystal accepts a monochromatic
	beam.  Asymmetrically cut crystals will diffract at slightly different
	angles than symmetrically cut crystals, because the entrance and exit beams
	will be refracted by different amounts.  The control software does not 
	take index-of-refraction effects into account.

	<HR>
	
	<P><center><IMG SRC="hrSeqCtl_All_nested.adl.gif">
	<br>hrSeqCtl_All.adl (nested geometry)</IMG> </center>

	<P>This is the full control display for a high-resolution monochromator in
	the "nested" geometry.  At top left are energy and wavelength drive areas,
	with columns of numbers in the standard form for motors.  From the top:
	HighLimit, Readback, Drive, LowLimit, and Tweak. In the middle are the
	crystal parameters and Bragg-angle drive area for the first crystal, 'TH1'
	(i.e., the crystal surface that the beam hits first, and its channel-cut
	pair, if any).  At right are the crystal parameters and drive area for the
	second crystal, 'TH2'.  The software makes sure all these fields are
	consistent with each other, so you can control the monochromator with any
	of them.

	<P>High and low limits of energy, wavelength, and the Bragg angles are
	calculated from limits of the motors that actually drive crystals, the Phi1
	and Phi2 motors.  These motors have engineering units of microradians, and
	may have small angular ranges about an offset angle that the software
	calculates but needn't be able to read or drive.  The software simply
	assumes, for example, that when Phi1 is at zero, the Phi1 crystal is
	oriented at the displayed offset angle.

	<P>Below the heavy black line is the connection between calculated Bragg
	angles and actual crystal motions. When a change is made to any of energy,
	wavelength, or Bragg angle, the software reconciles all the other values,
	according to the mode ("Theta1 only"; "Theta1 and Theta2"; "Rock Theta2")
	switch, and calculates the actual crystal angles (Phi1, Phi2) required to
	achieve the new Bragg angles.  These new crystal angles are displayed in
	the bottom row of values under the "Phi 1" and "Phi 2" headings.  If the
	"calibration" switch is set to "Use", new Phi-motor drive values are
	calculated from the Phi values, by subtracting the offsets and converting
	from degrees to microradians.  If the "Calibrate" switch is set to "Set",
	the offsets are calculated from the new Phi values and the existing motor
	positions.

	<P>After new Phi-motor values have been calculated, they are adjusted by
	the "world" offset, an arbitrary angle by which the user can allow for
	small shifts in the incident beam angle.

	<P>When new, adjusted  Phi-motor values have been calculated, they are
	displayed in the orange "Motor Write" row under the "Phi 1" and "Phi 2"
	headings.  If the "Manual"/Auto" switch is set to "Auto", the new values
	will also be written to the motors.  If the "Manual"/Auto" switch is set to
	"Manual", this will happen only when the "Move" button is pressed.

	<P><center><IMG SRC="hr_symmetric.adl.gif"> <br>hr_symmetric.adl (symmetric
	geometry)</IMG></center>
	
	<P>This display is a cartoon of the symmetric high-resolution monochromator
	geometry, defining the meanings of the angles Theta and Phi.  Although this
	diagram shows two channel-cut pairs of identical crystals, the crystals
	needn't be identical.

	<center><IMG SRC="hrSeqCtl_All_symmetric.adl.gif"> <br>hrSeqCtl_All.adl
	(symmetric geometry)</img></center>

	<P>Description

	<H4>Spherical Grating (Phi, r<sub>entrance</sub>, r<sub>exit</sub>)</H4>

	<P><center><IMG SRC="SGM.adl.html">SGM.adl</IMG> </center>

	<P>Description

	<HR>
	<IMG SRC="SGM_tiny.adl.html">SGM_tiny.adl</A>
	<P>Description

	<HR>

	<H3>Slits</H3>
		<TABLE CELLSPACING=0 CELLPADDING=0>
		<TR VALIGN=TOP><TD><A HREF="2slit.adl.html">2slit.adl</A> <TD>2-leaf slit: (X<sub>+</sub>, X<sub>-</sub>, X<sub>center</sub>, X<sub>width</sub>)
		<TR VALIGN=TOP><TD><A HREF="4slitGraphic.adl.html">4slitGraphic.adl~</A> <TD>4-leaf slit (horiz & vert 2-leaf slits)
		<TR VALIGN=TOP><TD><A HREF="trs.adl.html">trs.adl~</A> <TD>2-leaf slit: (cylinders on a rotation stage) on a translation stage
		</TABLE>

	<H3>Mirrors</H3>
		<TABLE CELLSPACING=0 CELLPADDING=0>
		<TR VALIGN=TOP><TD><A HREF="2postMirror.adl.html">2postMirror.adl~</A> <TD>Y<sub>upstream</sub>, Y<sub>downstream</sub>, Y<sub>average</sub>, Theta<sub>X</sub>
		</TABLE>

	<H3>Filters</H3>
		<TABLE CELLSPACING=0 CELLPADDING=0>
		<TR VALIGN=TOP><TD><A HREF="2filter.adl.html">2filter.adl</A> <TD>Two five-filter banks, with locking-solenoid control
		<TR VALIGN=TOP><TD><A HREF="2filter_setup.adl.html">2filter_setup.adl</A> <TD>specify filter materials, and the motor positions that put them into the beam
		<TR VALIGN=TOP><TD><A HREF="4filter.adl.adl.html">4filter.adl~</A> <TD>Four five-filter banks, with locking-solenoid control
		<TR VALIGN=TOP><TD><A HREF="4filter_setup.adl.html">4filter_setup.adl~</A> <TD>specify filter materials, and the motor positions that put them into the beam
		</TABLE>

	<H3>Optical table</H3>
		<TABLE CELLSPACING=0 CELLPADDING=0>
		<TR VALIGN=TOP><TD><A HREF="tableRecord.html">tableRecord.html</A> <TD>The table record
		<TR VALIGN=TOP><TD><A HREF="table.adl.html">table.adl</A>~ <TD>x,y,z rotations and translations (virtual motors)
		<TR VALIGN=TOP><TD><A HREF="table_tiny.adl.html">table_tiny.adl~</A> <TD>like motorx_tiny.adl for virtual motors
		<TR VALIGN=TOP><TD><A HREF="table_full.adl.html">table_full.adl~</A> <TD>virtual and actual motors
		<TR VALIGN=TOP><TD><A HREF="table_help.adl.html">table_help.adl~</A> <TD>old docs
		<TR VALIGN=TOP><TD><A HREF="table_setup.adl.html">table_setup.adl~</A> <TD>specify dimensions, orientation, and location of the point fixed under rotations
		</TABLE>

<address>
    Suggestions and Comments to: <br>
    <a HREF="mailto:mooney@aps.anl.gov">Tim Mooney </a>:
    (mooney@aps.anl.gov) <br>
    Last modified: July 1, 2005 
</address>
</body>
</html>
